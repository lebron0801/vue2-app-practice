const scpClient = require('\x73\x63\x70\x32');
const ora = require('\x6f\x72\x61');
const chalk = require('\x63\x68\x61\x6c\x6b');
const server = require('\x2e\x2f\x70\x72\x6f\x64\x75\x63\x74\x73');
const Client = require('\x73\x73\x68\x32')['\x43\x6c\x69\x65\x6e\x74'];
const spinner = ora(
	'\u6b63\u5728\u53d1\u5e03\u5230' +
		(process['\x65\x6e\x76']['\x4e\x4f\x44\x45\x5f\x45\x4e\x56'] === '\x75\x74'
			? '\x6b\x6e\x6f\x78'
			: '\u6d4b\u8bd5') +
		'\u670d\u52a1\u5668\x2e\x2e\x2e'
);
const deploing = ora('\u6b63\u5728\u90e8\u7f72\u4e2d\x2e\x2e\x2e');
const conn = new Client();
conn['\x6f\x6e']('\x72\x65\x61\x64\x79', function() {
	conn['\x65\x78\x65\x63'](
		`rm -rf ${server['\x70\x61\x74\x68']}/${server['\x70\x61\x63\x6b\x4e\x61\x6d\x65']}`,
		function($XJitfQOP1, JBA2) {
			if ($XJitfQOP1) throw $XJitfQOP1;
			JBA2['\x6f\x6e']('\x63\x6c\x6f\x73\x65', function(B$t3, j4) {
				spinner['\x73\x74\x61\x72\x74']();
				scpClient['\x73\x63\x70'](
					'\x64\x69\x73\x74\x2f',
					{
						host: server['\x68\x6f\x73\x74'],
						port: server['\x70\x6f\x72\x74'],
						username: server['\x75\x73\x65\x72\x6e\x61\x6d\x65'],
						password: server['\x70\x61\x73\x73\x77\x6f\x72\x64'],
						path: server['\x70\x61\x74\x68'] + '\x2f' + server['\x70\x61\x63\x6b\x4e\x61\x6d\x65']
					},
					function(LQ5) {
						spinner['\x73\x74\x6f\x70']();
						if (LQ5) {
							console['\x6c\x6f\x67'](chalk['\x72\x65\x64']('\u53d1\u5e03\u5931\u8d25\x2e\n'));
							throw LQ5;
						} else {
							deploing['\x73\x74\x61\x72\x74']();
							conn['\x65\x78\x65\x63'](
								`docker stop ${server['\x63\x6f\x6e\x74\x61\x69\x6e\x65\x72\x4e\x61\x6d\x65']}\n\x64\x6f\x63\x6b\x65\x72 rm ${server['\x63\x6f\x6e\x74\x61\x69\x6e\x65\x72\x4e\x61\x6d\x65']}\n\x64\x6f\x63\x6b\x65\x72 rmi ${server['\x69\x6d\x61\x67\x65\x4e\x61\x6d\x65']}\n\x64\x6f\x63\x6b\x65\x72 build -t ${server['\x69\x6d\x61\x67\x65\x4e\x61\x6d\x65']} ${server['\x70\x61\x74\x68']}\n\x64\x6f\x63\x6b\x65\x72 run --name ${server['\x63\x6f\x6e\x74\x61\x69\x6e\x65\x72\x4e\x61\x6d\x65']} -d -p ${server['\x73\x69\x74\x65\x50\x6f\x72\x74']}:${server['\x63\x6f\x6e\x74\x61\x69\x6e\x65\x72\x50\x6f\x72\x74']} ${server['\x69\x6d\x61\x67\x65\x4e\x61\x6d\x65']}`,
								function(rmoJ6, lXIFY7) {
									lXIFY7['\x6f\x6e']('\x63\x6c\x6f\x73\x65', function(fs$d_yDv8, mGKb9) {
										deploing['\x73\x74\x6f\x70']();
										console['\x6c\x6f\x67'](
											chalk['\x67\x72\x65\x65\x6e'](
												'\x53\x75\x63\x63\x65\x73\x73\x21 \u6210\u529f\u53d1\u5e03\u5230' +
													(process['\x65\x6e\x76']['\x4e\x4f\x44\x45\x5f\x45\x4e\x56'] ===
													'\x70\x72\x6f\x64'
														? '\u751f\u4ea7'
														: '\u6d4b\u8bd5') +
													'\u670d\u52a1\u5668\x21 \n'
											)
										);
										conn['\x65\x6e\x64']();
									})
										['\x6f\x6e']('\x64\x61\x74\x61', function(J10) {
											console['\x6c\x6f\x67']('\x53\x54\x44\x4f\x55\x54\x3a ' + J10);
										})
										['\x73\x74\x64\x65\x72\x72']['\x6f\x6e']('\x64\x61\x74\x61', function(
											LmwdJRh11
										) {
											console['\x6c\x6f\x67']('\x53\x54\x44\x45\x52\x52\x3a ' + LmwdJRh11);
										});
								}
							);
						}
					}
				);
			})
				['\x6f\x6e']('\x64\x61\x74\x61', function(PmjVGskK12) {
					console['\x6c\x6f\x67']('\x53\x54\x44\x4f\x55\x54\x3a ' + PmjVGskK12);
				})
				['\x73\x74\x64\x65\x72\x72']['\x6f\x6e']('\x64\x61\x74\x61', function(QBev13) {
					console['\x6c\x6f\x67']('\x53\x54\x44\x45\x52\x52\x3a ' + QBev13);
				});
		}
	);
})['\x63\x6f\x6e\x6e\x65\x63\x74']({
	host: server['\x68\x6f\x73\x74'],
	port: server['\x70\x6f\x72\x74'],
	username: server['\x75\x73\x65\x72\x6e\x61\x6d\x65'],
	password: server['\x70\x61\x73\x73\x77\x6f\x72\x64']
});
